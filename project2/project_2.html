<html>
	<body>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://d3js.org/d3.v4.js"></script>
		<script> 
		var data;
		var matrix_data = [];
		
		$.get('http://localhost:8000/temperature_copenhagen.txt', function(d){
			data = d;
			
			
			
			data = data.split(/\r?\n/);
			data.shift();
			
			for(var i = 0; i < data.length; i++){
				var line = data[i].split(/[ ]+/);
				line.shift();
				matrix_data.push(line);
			}
			
			
			// Flatten matrix
			var m = matrix_data.length;
			var n = matrix_data[0].length;
			flat_data = [].concat.apply([], matrix_data);


			// Largest value in data. Used to scale colors.
			var maxval = d3.max(flat_data);

			// Initialiation function. Called after body has loaded
			var w = 1000;
			var h = 1000;
			var svg = d3.select('body')
					  .append('svg')
					  .attr('width', w)
					  .attr('height', h);

			var sqW = w/n;
			var sqH = h/m;

			// Create rects for entry and color them according to value
			svg.selectAll('rect')
			  .data(flat_data)  
			  .enter()
			  .append('rect')
			  .attr('x',function(d,i){
				var col = i%n;
				var offset = 10;
				return col*sqW+offset;
			  })
			  .attr('y',function(d,i){
				var row = Math.floor(i/n);
				var offset = 10;
				return row*sqH+offset;
			  })
			  .attr('width' , w/n+1)
			  .attr('height', h/m+1)
			  .style('fill',function(d){
				var I = Math.round(120*(1 - d/maxval)+150);
				return 'rgb('+I+','+(I-100)+','+(I-100)+')'; 
			  });
		});
		
		</script>
		
		
		
		<title>D3 Page Template</title>
		<div id="foo"></div>
	</body>
</html>